{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{6578:function(e,t,a){\"use strict\";var n=a(\"9Jkg\"),i=a.n(n),s=a(\"ln6h\"),r=a.n(s),o=a(\"0iUn\"),l=a(\"sLSF\"),c=a(\"MI3g\"),u=a(\"a7VT\"),p=a(\"AT/M\"),d=a(\"Tit0\"),m=a(\"vYYK\"),h=a(\"q1tI\"),g=a.n(h),f=a(\"tRbT\"),b=a(\"ofer\"),v=a(\"r9w1\"),x=a(\"Z3vd\"),y=a(\"Hk+Y\"),w=a.n(y),C=a(\"nOHt\"),S=a.n(C),O=a(\"e2hQ\"),j=a(\"a6RD\"),k=a.n(j),T=a(\"obyI\"),N=g.a.createElement,W=k()((function(){return Promise.all([a.e(19),a.e(18),a.e(36)]).then(a.bind(null,\"NMZe\"))}),{ssr:!1,loadableGenerated:{webpack:function(){return[\"NMZe\"]},modules:[\"./filePond\"]}}),E=function(e){function t(e){var a;Object(o.a)(this,t),a=Object(c.a)(this,Object(u.a)(t).call(this,e)),Object(m.a)(Object(p.a)(a),\"componentDidMount\",(function(){var e,t=[],n=[];if(a.props.categories.map((function(e){-1===t.indexOf(e.maincategory)&&(t.push(e.maincategory),n.push({label:e.maincategory,value:e.catindex}))})),a.setState({maincategories:n}),a.state.keyindex){var i=(e=a.state.catindex,a.props.categories.filter((function(t){return t.catindex===e}))),s=[];i.map((function(e){s.push({label:e.subcategory,value:e.keyindex})})),a.setState({subcategories:s})}var r=[];a.props.citydata.map((function(e){r.push({label:e.city,value:e.city.toLowerCase()})})),a.setState({citydata:r})})),Object(m.a)(Object(p.a)(a),\"_handleChangeCity\",(function(e){a.setState({cities:e.target.value})})),Object(m.a)(Object(p.a)(a),\"_handleChangeCategory\",(function(e){a.setState({keyindex:\"\"}),a.setState({catindex:e.target.value});var t,n=(t=e.target.value,a.props.categories.filter((function(e){return e.catindex===t}))),i=[];n.map((function(e){i.push({label:e.subcategory,value:e.keyindex})})),a.setState({subcategories:i})})),Object(m.a)(Object(p.a)(a),\"_handleChangeSubCategory\",(function(e){a.setState({keyindex:e.target.value})})),Object(m.a)(Object(p.a)(a),\"handleSubmit\",(function(e){var t;return r.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:e.preventDefault(),a.setState({error:\"\"}),t=[],a.ref1.getFiles().map((function(e){return e.file})).forEach((function(e){var n=e.name.split(\".\")[0],i=\"\".concat(n,\".jpg\");t.push({name:i,owner:a.props.user.username})})),a.setState({uploads:t},a.handleSave);case 5:case\"end\":return n.stop()}}))})),Object(m.a)(Object(p.a)(a),\"handleSave\",(function(e){var t,n,s;return r.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return\"/api/dashboard/post/edit\",e.prev=1,e.next=4,r.a.awrap(fetch(\"/api/dashboard/post/edit\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:i()(a.state)}));case 4:if(200!==(t=e.sent).status){e.next=9;break}S.a.push(\"/dashboard\"),e.next=13;break;case 9:throw console.log(\"Edit failed.\"),(n=new Error(t.statusText)).response=t,n;case 13:e.next=20;break;case 15:e.prev=15,e.t0=e.catch(1),console.error(\"You have an error in your code or there are Network issues.\",e.t0),s=e.t0.response,a.setState({error:s?s.statusText:e.t0.message});case 20:case\"end\":return e.stop()}}),null,null,[[1,15]])}));var n=a.props.user,s=a.props.post||[];return a.ref1=g.a.createRef(),a.state={id:a.props.post?a.props.post.id:void 0,owner:s.owner||n.username,firstname:s.firstname||\"\",lastname:s.lastname||\"\",country:s.country||T.COUNTRYCODE,age:s.age||\"\",email:s.email||n.email,avatar:s.files||\"\",catindex:s.catindex||\"\",keyindex:s.keyindex||\"\",cities:s.cities||\"\",location:s.location||\"\",title:s.title||\"\",phone:s.phone||\"\",price:s.price||\"\",description:s.description||\"\",website:s.website||\"\",rawcities:a.props.citydata,citydata:[],countries:[],currencies:[],maincategories:[],subcategories:[],error:\"\",files:s?a.props.post.files:[],newfiles:[]},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:\"onUpdateFiles\",value:function(e){console.log(e)}},{key:\"render\",value:function(){var e=this,t=(this.props.user,this.props.post,this.props.classes);return N(g.a.Fragment,null,N(\"form\",{noValidate:!0,onSubmit:this.handleSubmit},N(f.a,{container:!0,spacing:4},N(f.a,{item:!0,xs:12,sm:4},\"Photo\",N(\"div\",{style:{minHeight:\"310px\"}},N(W,{onupdatefiles:this.onUpdateFiles.bind(this),setRef:function(t){return e.ref1=t},files:this.props.post.files,handleUploadImages:this.handleUploadImages}))),N(f.a,{item:!0,xs:12,sm:4},N(f.a,{container:!0,spacing:3},N(f.a,{item:!0,xs:12,sm:12},N(b.a,{variant:\"h6\",gutterBottom:!0},\"Ad Details\")),N(f.a,{item:!0,xs:12},N(O.a,{options:this.state.maincategories,value:this.state.catindex,placeholder:\"Category\",name:\"category\",onChange:this._handleChangeCategory})),N(f.a,{item:!0,xs:12},N(O.a,{options:this.state.subcategories,value:this.state.keyindex,placeholder:\"Subcategory\",name:\"subcategory\",onChange:this._handleChangeSubCategory})),N(f.a,{item:!0,xs:12},N(O.a,{options:this.state.citydata,value:this.state.cities,placeholder:\"City\",name:\"city\",onChange:this._handleChangeCity})),N(f.a,{item:!0,xs:12},N(v.a,{required:!0,id:\"title\",name:\"title\",label:\"Title\",fullWidth:!0,autoComplete:\"title\",value:this.state.title,variant:\"outlined\",onChange:function(t){return e.setState({title:t.target.value})}})),N(f.a,{item:!0,xs:12},N(v.a,{id:\"price\",name:\"price\",label:\"Price\",fullWidth:!0,autoComplete:\"price\",value:this.state.price,variant:\"outlined\",onChange:function(t){return e.setState({price:t.target.value})}})),N(f.a,{item:!0,xs:12,sm:12},N(v.a,{id:\"description\",label:\"Description\",name:\"description\",multiline:!0,fullWidth:!0,rows:\"10\",value:this.state.description,variant:\"outlined\",onChange:function(t){return e.setState({description:t.target.value})}})),N(f.a,{item:!0,xs:12,sm:12},N(v.a,{id:\"website\",name:\"website\",label:\"Website URL (inc https://)\",fullWidth:!0,autoComplete:\"Website\",value:this.state.website,variant:\"outlined\",onChange:function(t){return e.setState({website:t.target.value})}})))),N(f.a,{item:!0,xs:12,sm:4},N(f.a,{container:!0,spacing:3},N(f.a,{item:!0,xs:12,sm:12},N(b.a,{variant:\"h6\",gutterBottom:!0},\"Contact Details\")),N(f.a,{item:!0,xs:12,sm:12},N(v.a,{required:!0,id:\"firstname\",name:\"firstname\",label:\"First Name\",fullWidth:!0,autoComplete:\"firstname\",value:this.state.firstname,onChange:function(t){return e.setState({firstname:t.target.value})}})),N(f.a,{item:!0,xs:12,sm:12},N(v.a,{required:!0,id:\"lastname\",name:\"lastname\",label:\"Last Name\",fullWidth:!0,autoComplete:\"lastname\",value:this.state.lastname,onChange:function(t){return e.setState({lastname:t.target.value})}})),N(f.a,{item:!0,xs:12,sm:12},N(v.a,{required:!0,id:\"age\",name:\"age\",label:\"Age\",fullWidth:!0,autoComplete:\"age\",value:this.state.age,onChange:function(t){return e.setState({age:t.target.value})}})),N(f.a,{item:!0,xs:12,sm:12},N(v.a,{required:!0,id:\"phone\",name:\"phone\",label:\"Phone Number\",fullWidth:!0,autoComplete:\"phone\",value:this.state.phone,onChange:function(t){return e.setState({phone:t.target.value})}})),N(f.a,{item:!0,xs:12,sm:12},N(v.a,{required:!0,id:\"email\",name:\"email\",label:\"Email Address\",fullWidth:!0,autoComplete:\"email\",value:this.state.email,onChange:function(t){return e.setState({email:t.target.value})}})),N(f.a,{item:!0,xs:12,sm:12},N(x.a,{type:\"submit\",fullWidth:!0,variant:\"contained\",color:\"primary\",className:t.submit},\"Submit\"))))),this.state.error&&N(\"p\",{className:\"error\"},\"Error: \",this.state.error)))}}]),t}(g.a.Component);t.a=w()((function(e){return{\"@global\":{body:{backgroundColor:e.palette.common.white}},paper:{marginTop:e.spacing(8),display:\"flex\",flexDirection:\"column\",alignItems:\"center\"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:\"100%\",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)}}}))(E)},Vkal:function(e,t,a){\"use strict\";a.r(t);var n=a(\"ln6h\"),i=a.n(n),s=a(\"vYYK\"),r=a(\"Ji2X\"),o=a(\"5CWz\"),l=a(\"tRbT\"),c=a(\"kKAo\"),u=a(\"R/WZ\"),p=a(\"iuhU\"),d=a(\"q1tI\"),m=a.n(d),h=a(\"HIzg\"),g=a(\"vwXi\"),f=a(\"ojGB\"),b=a(\"6578\"),v=a(\"obyI\"),x=a.n(v),y=a(\"SMlj\"),w=a(\"t+dt\"),C=a(\"nOHt\"),S=m.a.createElement,O=Object(u.a)((function(e){return{root:{display:\"flex\"},drawerPaper:{position:\"relative\",whiteSpace:\"nowrap\",width:240,transition:e.transitions.create(\"width\",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen})},drawerPaperClose:Object(s.a)({overflowX:\"hidden\",transition:e.transitions.create(\"width\",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),width:e.spacing(7)},e.breakpoints.up(\"sm\"),{width:e.spacing(9)}),appBarSpacer:e.mixins.toolbar,content:{flexGrow:1,height:\"100vh\",overflow:\"auto\"},container:{paddingTop:e.spacing(4),paddingBottom:e.spacing(4)},paper:{padding:e.spacing(2),display:\"flex\",overflow:\"auto\",flexDirection:\"column\"},paperCust:{padding:\"24px\"},fixedHeight:{height:240}}})),j=function(e){e.user;var t=O();Object(p.default)(t.paper,t.fixedHeight),Object(C.useRouter)().query.id;return S(f.a,{user:e.user,categories:e.cat},S(\"div\",{className:t.root},S(o.a,null),S(g.a,null),S(\"main\",{className:t.content},S(\"div\",{className:t.appBarSpacer}),S(r.a,{maxWidth:\"lg\",className:t.container},S(\"h1\",null,\"Edit Post\"),S(l.a,{container:!0,spacing:3},S(l.a,{item:!0,xs:12,md:12,lg:12},S(c.a,{className:t.paperCust},S(b.a,{user:e.user,categories:e.categories,citydata:e.citydata,post:e.post}))))),S(h.a,null))))};j.getInitialProps=function(e){var t,a,n,s,r;return i.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return t=e.query,a=x.a.COUNTRYCODE,o.next=4,i.a.awrap(w.g(a));case 4:return n=o.sent,s=t.id,o.next=8,i.a.awrap(w.h(s));case 8:return r=o.sent,o.abrupt(\"return\",{citydata:n,query:t,post:r});case 10:case\"end\":return o.stop()}}))},t.default=Object(y.d)(j)},VpTJ:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push([\"/dashboard/editpost/[id]\",function(){return a(\"Vkal\")}])}},[[\"VpTJ\",0,2,1,3,4,5,6,7,8,9,13,15]]]);"}