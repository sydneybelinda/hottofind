{"ast":null,"code":"import _JSON$stringify from \"@babel/runtime-corejs2/core-js/json/stringify\";\nimport fetch from \"isomorphic-unfetch\";\nimport nextCookie from \"next-cookies\";\nimport { API } from \"../config\";\nexport const deletePost = async id => {\n  console.log(id);\n  const url = `/api/post/delete`;\n\n  try {\n    const response = await fetch(url, {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      body: _JSON$stringify({\n        id: id\n      })\n    });\n\n    if (response.status === 200) {\n      // Router.push('/dashboard')\n      window.location.reload();\n    } else {\n      console.log(\"Delete failed.\"); // https://github.com/developit/unfetch#caveats\n\n      let error = new Error(response.statusText);\n      error.response = response;\n      throw error;\n    }\n  } catch (error) {\n    console.error(\"You have an error in your code or there are Network issues.\", error);\n  }\n};\nexport const deleteFile = async name => {\n  console.log(name);\n  const url = `/api/dashboard/file/delete`;\n\n  try {\n    const response = await fetch(url, {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      body: _JSON$stringify({\n        name: name\n      })\n    });\n\n    if (response.status === 200) {\n      // Router.push('/dashboard')\n      return {\n        status: \"Sucess\"\n      };\n    } else {\n      console.log(\"Delete failed.\"); // https://github.com/developit/unfetch#caveats\n\n      let error = new Error(response.statusText);\n      error.response = response;\n      throw error;\n    }\n  } catch (error) {\n    console.error(\"You have an error in your code or there are Network issues.\", error);\n  }\n};\nexport const getUserPosts = async username => {\n  const res = await fetch(`${API}/posts/byuser/${username}`);\n  let posts = await res.json();\n  return posts;\n};\nexport const checkUserLogin = async ctx => {\n  const {\n    token\n  } = nextCookie(ctx); //console.log(token)\n  //   const apiUrl = getHost(ctx.req) + \"/api/profile\";\n\n  const apiUrl = `${API}/profile`;\n\n  const redirectOnError = () => false ? Router.push(\"/login\") : ctx.res.writeHead(302, {\n    Location: \"/login\"\n  }).end();\n\n  try {\n    const response = await fetch(apiUrl, {\n      credentials: \"include\",\n      headers: {\n        // Authorization: JSON.stringify({ token })\n        Authorization: token\n      }\n    });\n\n    if (response.ok) {\n      const js = await response.json();\n      const user = js.data;\n      return user;\n    } else {\n      return await redirectOnError();\n    }\n  } catch (error) {\n    // Implementation or Network error\n    return redirectOnError();\n  }\n};\nexport const getPost = async id => {\n  const url = `${API}/post/id/${id}`;\n  const data = await fetch(url);\n  const post = await data.json();\n  return post;\n};\nexport const getCities = async countrycode => {\n  const url = `${API}/city/get/${countrycode}`;\n  const data = await fetch(url);\n  let cities = await data.json();\n  return cities;\n};\nexport const getAllCities = async () => {\n  const url = `${API}/city/get`;\n  const data = await fetch(url);\n  let cities = await data.json();\n  return cities;\n};\nexport const getCategories = async () => {\n  const url = `${API}/category/get`;\n  const data = await fetch(url);\n  let categories = await data.json();\n  return categories;\n};\nexport const getlatest = async c => {\n  const url = `${API}/posts/latest?countrycode=${c}`;\n  const data = await fetch(url);\n  let posts = await data.json();\n  return posts;\n};\nexport const submitProfile = async e => {\n  const url = `${API}/dashboard/profile/edit`;\n  const data = await fetch(url, {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\"\n    },\n    body: _JSON$stringify(e)\n  });\n  let submit = await data.json();\n  return submit;\n};\nexport const uploadProfilePhoto = async e => {\n  const url = `${API}/dashboard/profile/changeavatar`;\n\n  try {\n    const data = await fetch(url, {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      body: _JSON$stringify(e)\n    });\n    let resp = await data;\n    return resp;\n  } catch (error) {\n    console.error(\"You have an error in your code or there are Network issues.\", error);\n    const {\n      resp\n    } = error.json();\n    return resp;\n  }\n};\nexport const deleteAvatar = async e => {\n  const url = `${API}/dashboard/profile/deleteavatar`;\n\n  try {\n    const data = await fetch(url, {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      body: _JSON$stringify(e)\n    });\n    let resp = await data;\n    return resp;\n  } catch (error) {\n    console.error(\"You have an error in your code or there are Network issues.\", error);\n    const {\n      resp\n    } = error.json();\n    return resp;\n  }\n};","map":null,"metadata":{},"sourceType":"module"}